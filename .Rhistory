library(dplyr)
library(gganimate)
remotes::install_github("wiscostret/fplscrapR")
library(fplscrapR)
install.packages("curl")
remotes::install_github("wiscostret/fplscrapR")
library(curl)
install.packages("curl")
remotes::install_github("wiscostret/fplscrapR")
library(fplscrapR)
library(ggplot2)
mytheme <- theme(axis.line=element_blank(),
axis.text.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
legend.position="none",
panel.background=element_blank(),
panel.border=element_blank(),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.grid.major.x = element_line( size=.1, color="grey" ),
panel.grid.minor.x = element_line( size=.1, color="grey" ),
plot.title=element_text(size=25, hjust=0.5, face="bold", colour="grey", vjust=-1),
plot.subtitle=element_text(size=18, hjust=0.5, face="italic", color="grey"),
plot.caption =element_text(size=8, hjust=0.5, face="italic", color="grey"),
plot.background=element_blank(),
plot.margin = margin(2,2, 2, 4, "cm"))
cbbPalette <- c("#000000", "#E69F00", "#56B4E9", "#009E73", "#F0E442")
#ids for each team
ids <- c(3521912,
1014999,
3577869,
1623282,
2260523)
#scrape data
route1NZ <- lapply(ids, get_entry_season)
#add to one data frame
route1_df <- bind_rows(route1NZ)
route1_df <- arrange(route1_df,event,overall_rank)
#work out WBW rank
route1_df <- route1_df %>%
dplyr::group_by(event) %>%
dplyr::mutate(week_rank = rank(overall_rank, ties.method = 'first'))
# Basic barplot:
p1 <- ggplot(route1_df, aes(x=total_points, y=name, fill=name)) +
geom_bar(stat='identity')+
scale_fill_manual(values=cbbPalette)
p1
# Make a ggplot, but add frame=year: one image per year
ggplot(route1_df, aes(x=total_points, y=name, fill=name)) +
geom_tile(aes(y = total_points, height = total_points,width = 5),
alpha = 0.8, color = "black") +
theme_bw() +
scale_fill_manual(values=cbbPalette)+
#scale_y_continuous(labels = scales::comma) +
#guides(color = FALSE, fill = FALSE) +
# gganimate specific bits:
transition_states(event, transition_length = 1, state_length = 1, wrap = FALSE) +
#view_follow(fixed_x = TRUE)+
ease_aes('sine-in-out')
ggplot(route1_df, aes(total_points, group = name,
fill = as.factor(name), color = as.factor(name))) +
geom_tile(aes(y = total_points, height = total_points,width = 30),
alpha = 0.8, color = "black") +
geom_text(aes(y = 0, label = paste(name, " ")),size = 4, vjust = 0.2, hjust = 1) +
geom_text(aes(y=total_points,label = round(total_points,0))) +
geom_text(aes(y=week_rank,label =week_rank)) +
coord_flip(clip = "off", expand = FALSE) +
scale_y_continuous(labels = scales::comma) +
scale_fill_manual(values=cbbPalette)+
#scale_x_reverse() +
guides(color = FALSE, fill = FALSE) +
mytheme+
transition_states(event, transition_length = 1, state_length = 1, wrap = FALSE) +
view_follow(fixed_y = TRUE)  +
labs(title = 'FPL - Route 1 NZ : {closest_state}',
subtitle  =  "Accumulated points",
caption  = "Total points | Data Source: fplscrapR")
anim
animate(anim, 400, fps = 5,  width = 800, height = 400,
renderer = gifski_renderer("fpl_titleRace.gif"), end_pause = 15, start_pause =  15)
ggplot(route1_df, aes(total_points, group = name,
fill = as.factor(name), color = as.factor(name))) +
geom_tile(aes(y = total_points, height = total_points,width = 30),
alpha = 0.8, color = "black") +
geom_text(aes(y = 0, label = paste(name, " ")),size = 4, vjust = 0.2, hjust = 1) +
geom_text(aes(y=total_points,label = round(total_points,0))) +
geom_text(aes(y=week_rank,label =week_rank)) +
coord_flip(clip = "off", expand = FALSE) +
scale_y_continuous(labels = scales::comma) +
scale_fill_manual(values=cbbPalette)+
#scale_x_reverse() +
guides(color = FALSE, fill = FALSE) +
mytheme+
transition_states(event, transition_length = 1, state_length = 1, wrap = FALSE) +
view_follow(fixed_y = TRUE)  +
labs(title = 'FPL - Route 1 NZ : {closest_state}',
subtitle  =  "Accumulated points",
caption  = "Total points | Data Source: fplscrapR")
